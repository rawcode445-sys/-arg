<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THE FIRST IMPACT OF RAW//CODE</title>
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>

<div id="intro" class="intro">
  <pre id="introText">
SYSTEM ACCESS // RAW_SUPREMACY_01
INITIALIZING PROTOCOL...
ACCESS GRANTED_
  </pre>
</div>

<div id="main" class="hidden">
  <h1 class="title">THE FIRST IMPACT OF RAW//CODE</h1>
  <div class="poster-container">
    <img id="poster" src="assets/img/poster-final.jpg" alt="poster">
    <div class="mask" id="m1" data-rect="66,38,34,9"></div>
    <div class="mask" id="m2" data-rect="13,52,30,11.5"></div>
    <div class="mask" id="m3" data-rect="52,63,34,11"></div>
    <div class="mask" id="m4" data-rect="9,72,44,11.5"></div>
    <div class="mask" id="m5" data-rect="53,78,36,11"></div>
  </div>

  <div class="questions">
    <div><input id="q1" placeholder="Q1"><button id="b1">OK</button></div>
    <div><input id="q2" placeholder="Q2"><button id="b2">OK</button></div>
    <div><input id="q3" placeholder="Q3"><button id="b3">OK</button></div>
    <div><input id="q4" placeholder="Q4"><button id="b4">OK</button></div>
    <div><input id="q5" placeholder="Q5"><button id="b5">OK</button></div>
  </div>
</div>

<script>
function positionMasks() {
  const img = document.getElementById('poster');
  const rect = img.getBoundingClientRect();
  document.querySelectorAll('.mask').forEach(el => {
    const [x,y,w,h] = el.dataset.rect.split(',').map(parseFloat);
    const left = (x/100)*rect.width;
    const top = (y/100)*rect.height;
    const width = (w/100)*rect.width;
    const height = (h/100)*rect.height;
    Object.assign(el.style, {
      left:left+'px', top:top+'px', width:width+'px', height:height+'px',
      backgroundSize: rect.width+'px '+rect.height+'px',
      backgroundPosition: '-'+left+'px -'+top+'px'
    });
  });
}
addEventListener('load', positionMasks);
addEventListener('resize', positionMasks);

function playRevealSound() {
  const audio = new Audio('assets/sfx/glitch.wav');
  audio.volume = 0.6;
  audio.play().catch(() => {});
}

function unlock(maskId, inputId, correctAnswers) {
  const val = document.getElementById(inputId).value.trim().toUpperCase();
  const mask = document.getElementById(maskId);
  if (correctAnswers.includes(val)) {
    if (!mask.classList.contains('revealed')) {
      mask.classList.add('revealed');
      playRevealSound();
    }
  }
}

document.getElementById('b1').onclick = () => unlock('m1','q1',['HARDSTYLE']);
document.getElementById('b2').onclick = () => unlock('m2','q2',['KICKS']);
document.getElementById('b3').onclick = () => unlock('m3','q3',['FIRE']);
document.getElementById('b4').onclick = () => unlock('m4','q4',['2']);
document.getElementById('b5').onclick = () => unlock('m5','q5',['UPTEMPO']);

window.addEventListener('load', ()=>{
  if(localStorage.getItem('introPlayed')) {
    document.getElementById('intro').style.display='none';
    document.getElementById('main').classList.remove('hidden');
  } else {
    setTimeout(()=>{
      document.getElementById('intro').style.display='none';
      document.getElementById('main').classList.remove('hidden');
      localStorage.setItem('introPlayed','true');
    },5000);
  }
});
</script>

</body>
</html>
