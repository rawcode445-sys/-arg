<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>THE FIRST IMPACT OF RAW//CODE</title>
<link rel="stylesheet" href="../../assets/css/style.css">
</head>
<body>
<div id="intro" class="intro">
  <pre>
SYSTEM ACCESS // RAW_SUPREMACY_01
INITIALIZING PROTOCOL...
ACCESS GRANTED_
  </pre>
</div>

<div id="main" class="hidden wrapper">
  <div class="term">
    <h2 class="title">THE FIRST IMPACT OF RAW//CODE</h2>
    <p class="center">27 NOVEMBRE 2025 — 20h → Courfaivre</p>

    <div class="poster">
      <img id="poster" src="../../assets/img/poster-final.jpg" alt="poster">
      <!-- masks -->
      <div class="mask" id="m1" data-rect="66,38,34,9"></div>
      <div class="mask" id="m2" data-rect="13,52,30,11.5"></div>
      <div class="mask" id="m3" data-rect="52,63,34,11"></div>
      <div class="mask" id="m4" data-rect="9,72,44,11.5"></div>
      <div class="mask" id="m5" data-rect="53,78,36,11"></div>
    </div>

    <div class="questions">
      <div><input id="q1" placeholder="RAW is a subgenre of ____ ?"><button id="b1">UNLOCK</button></div>
      <div><input id="q2" placeholder="Complete: RAW = distorted ____"><button id="b2">UNLOCK</button></div>
      <div><input id="q3" placeholder="BUILT ON BASS. FORGED IN ____."><button id="b3">UNLOCK</button></div>
      <div><input id="q4" placeholder="How many slashes in RAW//CODE ?"><button id="b4">UNLOCK</button></div>
      <div><input id="q5" placeholder="Ending style after RAW = ____"><button id="b5">UNLOCK</button></div>
    </div>
  </div>
</div>

<script>
function positionMasks(){
  const img=document.getElementById('poster');
  const rect=img.getBoundingClientRect();
  document.querySelectorAll('.mask').forEach(el=>{
    const [x,y,w,h]=el.dataset.rect.split(',').map(parseFloat);
    const left=(x/100)*rect.width, top=(y/100)*rect.height;
    const width=(w/100)*rect.width, height=(h/100)*rect.height;
    Object.assign(el.style,{
      left:left+'px', top:top+'px', width:width+'px', height:height+'px',
      backgroundSize: rect.width+'px '+rect.height+'px',
      backgroundPosition: '-'+left+'px -'+top+'px'
    });
  });
}
addEventListener('load', positionMasks);
addEventListener('resize', positionMasks);

// Reveal sound
function playRevealSound(){
  const a=new Audio('../../assets/sfx/glitch.wav'); a.volume=0.7; a.play().catch(()=>{});
}
function unlock(maskId, inputId, answers){
  const v=document.getElementById(inputId).value.trim().toUpperCase();
  const m=document.getElementById(maskId);
  if(answers.includes(v)){ if(!m.classList.contains('revealed')){ m.classList.add('revealed'); playRevealSound(); } }
}
b1.onclick=()=>unlock('m1','q1',['HARDSTYLE']);
b2.onclick=()=>unlock('m2','q2',['KICKS']);
b3.onclick=()=>unlock('m3','q3',['FIRE']);
b4.onclick=()=>unlock('m4','q4',['2']);
b5.onclick=()=>unlock('m5','q5',['UPTEMPO']);

// Intro once
window.addEventListener('load',()=>{
  if(localStorage.getItem('impact_intro_done')){
    document.getElementById('intro').style.display='none';
    document.getElementById('main').classList.remove('hidden');
  } else {
    setTimeout(()=>{
      document.getElementById('intro').style.display='none';
      document.getElementById('main').classList.remove('hidden');
      localStorage.setItem('impact_intro_done','1');
    },5000);
  }
});

// Debug rectangles
if(new URL(location.href).searchParams.get('debug')==='1'){
  document.querySelectorAll('.mask').forEach(m=>m.classList.add('debug'));
}
</script>
</body></html>
